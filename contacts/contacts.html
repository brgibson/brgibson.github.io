<!doctype html>
<html lang="en-US">
    <head>
        <meta charset="utf-8">
        <title>Ben's Experiments - Contacts Widget</title>
        <link rel="stylesheet" href="./contacts.css">
    </head>
    <body>
        <section> <!-- todo - how does the section element degrade in older browsers? -->
            <h1>Contacts</h1> <!-- todo - do I want to use an h1 here? - reference to consider: http://webdesign.tutsplus.com/articles/the-truth-about-multiple-h1-tags-in-the-html5-era--webdesign-16824 -->

            <!-- todo - we will need to associate an image with this user -->
            <!-- todo - would I prefer the "map" link to be a separate definition? -->

            <ul id="contacts">
                <!-- todo - include a sample of the final markup here -->    
            </ul>
            
            <select id="defaultDisplay">
                <option value="email">Email address</option>
                <option value="phone">Phone number</option>
            </select>
        </section>
        
        <script src="./tabularContactData.js"></script> <!-- contains a single variable "tabularContactData" - a String containing all of the contacts -->
        <script src="./convertTabularContactData.js"></script> <!-- contains a single variable "convertTabularContactData" - a function which takes a string of tabular contact data and returns the markup to be inserted into the "contacts" div -->
        <script>
            (function() {
                
                //add the contacts to the page
                var contactsContainer = document.getElementById("contacts")
                contactsContainer.innerHTML = convertTabularContactData(tabularContactData);

                //add event handler for email/phone select list
                var emailElements = [],
                    phoneElements = [];
                (function() {
                    var ddElements = contactsContainer.getElementsByTagName("dd");
                    for (var i = 0; i < ddElements.length; i++) {
                        switch (ddElements[i].getAttribute("data-type")) {
                            case "email": emailElements.push(ddElements[i]); break;
                            case "phone": phoneElements.push(ddElements[i]); break;
                        }
                    }
                })();
                
                var defaultDisplyInput = document.getElementById("defaultDisplay");
                defaultDisplyInput.onchange = (function(elementToListenToemailElements, phoneElements) { //todo- do i need to register the capture events? ie if (element.captureEvents) element.captureEvents(Event.CLICK);
                    
                    /* setup */
                    var show = function(elems, doNotShowFlag) {
                            for (var i = 0; i < elems.length; i++) {
                                elems[i].className = doNotShowFlag ? "" : "show";
                            }
                        },
                        hide = function(elems) {
                            return show(elems, true);
                        };

                    /* return function */
                    return function(type) {
                        switch(type) {
                            case "email":
                                show(emailElements);
                                hide(phoneElements);
                                break;
                            case "phone":
                                hide(emailElements);
                                show(phoneElements);
                                break;
                        }
                    };
                })(emailElements, phoneElements);
                
                //pick default
                document.getElementById("defaultDisplay").onchange("email");
                
               
            })();
            
            //todo - can we use schema.org attributes for targeting needed for email/phone link (ie. get elements by tag name - check for attribute 'blah')
        </script>
        <!-- todo - it might be cool to add a search function -->
    </body>
</html>